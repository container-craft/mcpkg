version: 1
unit: ledger
base: revoke
include_prefix: "mp"

fields:
  - { key: 2, name: kind,        type: u32,       required: true,  comment: "MCPKG_REVOKE_*" }
  - { key: 3, name: target_hash, type: "bin[32]", required: false, comment: "when kind=KEY or ATTESTATION" }
  - { key: 4, name: pkg_id,      type: str,       required: false, comment: "when kind=PACKAGE" }
  - { key: 5, name: version,     type: str,       required: false, comment: "when kind=PACKAGE" }
  - { key: 6, name: reason,      type: u32,       required: true,  comment: "MCPKG_REVOKE_REASON" }
  - { key: 7, name: ts_ms,       type: i64,       required: true }
